@using Hotel.Data.Entities
@model Hotel.Client.DTOs.RegisterDTOs
@{
	ViewData["Title"] = "Đăng ký tài khoản";
	var package = TempData["package"] as AppRentalPackage;
	var times = TempData["Time"] as List<AppTimes>;
}


<div class="auth-page-wrapper auth-bg-cover py-5 d-flex justify-content-center align-items-center min-vh-100">
	<div class="bg-overlay"></div>
	<!-- auth-page content -->
	<div class="auth-page-content overflow-hidden pt-lg-5" style="z-index: 0">
		<div class="container" style="z-index: 0">
			<div class="row">
				<div class="col-lg-12">
					<div class="card overflow-hidden m-0">
						<div class="row justify-content-center g-0">
							<div class="col-lg-6">
								<div class="p-lg-5 p-4 auth-one-bg h-100">
									<div class="bg-overlay"></div>
									<div class="position-relative h-100 d-flex flex-column">
										<div class="mb-4" style="font-size: 20px; color:honeydew">
											HMSoft.com
										</div>
										<div class="mt-auto">
											<div class="mb-3">
												<i class="ri-double-quotes-l display-4 text-success"></i>
											</div>

											<div id="qoutescarouselIndicators" class="carousel slide" data-bs-ride="carousel">
												<div class="carousel-indicators">
													<button type="button" data-bs-target="#qoutescarouselIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
													<button type="button" data-bs-target="#qoutescarouselIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
													<button type="button" data-bs-target="#qoutescarouselIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
												</div>
												<div class="carousel-inner text-center text-white pb-5">
													<div class="carousel-item active">
														<p class="fs-15 fst-italic">"Tương lai của ngành khách sạn nằm trong lòng bàn tay bạn "</p>
													</div>
													<div class="carousel-item">
														<p class="fs-15 fst-italic">"Chỉ cần một giải pháp thông minh, bạn đã sở hữu chìa khóa thành công của khách sạn"</p>
													</div>
													<div class="carousel-item">
														<p class="fs-15 fst-italic">"Vận hành khách sạn thông minh – nâng tầm trải nghiệm khách hàng "</p>
													</div>
												</div>
											</div>
											<!-- end carousel -->

										</div>
									</div>
								</div>
							</div>

							<div class="col-lg-6">
								<div class="p-lg-5 p-4">
									<div class="row">
										<h5 class="text-primary text-center">Đăng ký Phần Mềm Quản trị Khách Sạn</h5>
										<p class="text-muted text-center">Phần Mềm Quản trị Khách Sạn - Giải pháp quản lý khách sạn toàn diện</p>
									</div>

									<div class="mt-4">
										<form class="needs-validation" novalidate asp-action="Register">
											<div class="row mt-2">
												<div class="col-12 p-0 mx-auto">

													<div class="row mb-2">
														<div class="col p-0" >
															<span class="mx-auto p-0 h4" style=" border-bottom: 1px solid rgb(0, 66, 188);color: #bf8c0d;">Thông tin khách sạn</span>
														</div>
													</div>
													<div class="row w-100 mb-2">
														<span class="p-0">Tên khách sạn: </span>
														<input type="text" asp-for="HtelName" class="form-control mt-1" />
														<span asp-validation-for="HtelName" class="text-danger"></span>
													</div>
													<div class="row w-100 mb-2">
														<span class="p-0">Số điện thoại: </span>
														<input type="text" asp-for="HtelPhone" class="form-control mt-1" />
														<span asp-validation-for="HtelPhone" class="text-danger"></span>
													</div>

													<div class="row  w-100 my-1 mt-2">
														<span class="p-0">Địa chỉ:</span>
														<div class="col p-0 ">
															<select id="provinces" asp-for="HtelCity" class=" form-control rounded-1 w-100 border border-2 border-none  px-4">
															</select>
															<span asp-validation-for="HtelCity" class="text-danger"></span>
														</div>
														<div class="col p-0 " style="margin-left: 10px">
															<select id="districts" asp-for="HtelDistrict" class=" form-control rounded-1 w-100 border border-2 border-none  px-4">
																<option value='0'> -- Chọn Quận / Huyện -- </option>
															</select>
															<span asp-validation-for="HtelDistrict" class="text-danger"></span>
														</div>
													</div>

													@if (package != null && package.Price != 0)
													{
														<div class="row  w-100 my-1" style="padding-top: 10px">
															<span class="p-0">Tổng thời gian thuê website: </span>
															<div class="col p-0 mt-1">
																<input type="text" asp-for="Time" class="form-control" />
																<span asp-validation-for="Time" class="text-danger"></span>
															</div>
															<div class="col p-0" style="margin-left: 10px">
																<select asp-for="IdTime" class="form-control px-2 text-center border border-secondary form-select">
																	<option value="-1">-Chọn loại thời gian-</option>
																	@foreach (var item in times)
																	{
																		if (item.Id > 2)
																		{
																			<option value="@item.Id">@item.Name</option>
																		}
																	}
																</select>
															</div>
														</div>
													}
													<div class="row mb-2 mt-3">
														<div class="col p-0">
															<span class="mx-auto p-0 h4 " style=" border-bottom: 1px solid rgb(0, 66, 188); color: #bf8c0d;">Thông tin admin quản trị</span>
														</div>
													</div>
													
													<div class="row w-100 mb-2">
														<div class="col p-0">
															<span>Email admin khách sạn: </span>
															<input readonly type="text" asp-for="AdMail" class="form-control mt-1" />
															<span asp-validation-for="AdMail" class="text-danger"></span>
														</div>
													</div>
													<div class="row w-100  mb-2">
														<div class="col p-0">
															<span>Mật khẩu: </span>
															<input type="password" asp-for="AdPass" class="form-control mt-1" />
															<span asp-validation-for="AdPass" class="text-danger"></span>
														</div>
														<div class="col p-0" style="margin-left: 10px">
															<span>Nhập lại mật khẩu: </span>
															<input type="password" asp-for="AdCf_Pass" class="form-control mt-1" />
															<span asp-validation-for="AdCf_Pass" class="text-danger"></span>
														</div>
													</div>
												</div>
											</div>

											<div class="row  ">
												<div class="col d-flex justify-content-end p-0" style="margin-top:20px; margin-right: 10px">
													<a asp-action="ValidMail" style="margin: 15px 25px 0 0 "> <i class="fas fa-angle-double-left"></i> Trở về trang trước</a>
													<button type="submit" class="btn btn-success">Tiếp theo<i class=" fas fa-chevron-right" style="margin-left: 3px"></i></button>
												</div>
											</div>
										</form>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- end card -->
				</div>
				<!-- end col -->

			</div>
			<!-- end row -->
		</div>
		<!-- end container -->
	</div>
	<!-- end Footer -->
</div>
<script src="~/assets/js/layout.js"></script>
<!-- Bootstrap Css -->
<link href="~/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
<!-- Icons Css -->
<link href="~/assets/css/icons.min.css" rel="stylesheet" type="text/css" />
<!-- App Css-->
<link href="~/assets/css/app.min.css" rel="stylesheet" type="text/css" />
<!-- custom Css-->
<link href="~/assets/css/custom.min.css" rel="stylesheet" type="text/css" />



<script src="~/assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="~/assets/libs/simplebar/simplebar.min.js"></script>
<script src="~/assets/libs/node-waves/waves.min.js"></script>
<script src="~/assets/libs/feather-icons/feather.min.js"></script>
<script src="~/assets/js/pages/plugins/lord-icon-2.1.0.js"></script>
<script src="~/assets/js/plugins.js"></script>

<!-- validation init -->
<script src="~/assets/js/pages/form-validation.init.js"></script>
<!-- password create init -->
<script src="~/assets/js/pages/passowrd-create.init.js"></script>

<script>
	// ============== API địa chỉ =============

	document.addEventListener("DOMContentLoaded", function () {
		// Lấy dữ liệu tỉnh/thành phố từ API và thiết lập giá trị mặc định từ Model (nếu có)
		fetch("https://api.mysupership.vn/v1/partner/areas/province")
			.then(response => response.json())
			.then(data => {
				var provinces = document.getElementById("provinces");
				// Xóa tất cả các option hiện có trước khi thêm mới
				provinces.innerHTML = "";
				// Thêm option mặc định nếu không có dữ liệu từ Model
				if (provinces.options.length === 0) {
					var defaultOption = document.createElement("option");
					defaultOption.value = "0";
					defaultOption.text = " -- Chọn thành phố -- ";
					provinces.appendChild(defaultOption);
				}
				// Thêm dữ liệu từ API vào select box
				data.results.forEach(province => {
					var option = document.createElement("option");
					option.data = province.code;
					option.value = province.name;
					option.text = province.name;
					provinces.appendChild(option);
				});
			})
			.catch(error => {
				console.error('Error fetching provinces:', error);
				alert('Không thể tải danh sách tỉnh/thành phố. Vui lòng thử lại sau.');
			});

		// Cập nhật các select box khác khi thành phố được chọn
		document.getElementById("provinces").addEventListener("change", event => {
			var selectedIndex = event.target.selectedIndex;
			var tp = event.target.options[selectedIndex].data;

			fetch(`https://api.mysupership.vn/v1/partner/areas/district?province=${tp}`)
				.then(res => res.json())
				.then(data => {
					var districts = document.getElementById("districts");
					districts.innerHTML = "<option value='0'> -- Chọn quận/huyện -- </option>";
					data.results.forEach(district => {
						var option = document.createElement("option");
						option.data = district.code;
						option.value = district.name;
						option.text = district.name;
						districts.appendChild(option);
					});
				})
				.catch(error => {
					console.error('Error:', error);
				});
		});

		// Cập nhật xã/phường khi quận/huyện được chọn
		document.getElementById("districts").addEventListener("change", event => {
			var selectedIndex = event.target.selectedIndex;
			var districtCode = event.target.options[selectedIndex].data;
			fetch(`https://api.mysupership.vn/v1/partner/areas/commune?district=${districtCode}`)
				.then(res => res.json())
				.then(data => {
					var wards = document.getElementById("wards");
					wards.innerHTML = "<option value='0'> -- Chọn xã/phường -- </option>";
					data.results.forEach(ward => {
						var option = document.createElement("option");
						option.data = ward.code;
						option.value = ward.name;
						option.text = ward.name;
						wards.appendChild(option);
					});
				})
				.catch(error => {
					console.error('Error:', error);
				});
		});
	});
</script>